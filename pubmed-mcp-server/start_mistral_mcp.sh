#!/bin/bash

echo "üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º Mistral + MCP Server..."
echo ""

# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source ~/mlx_env/bin/activate

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd "$(dirname "$0")"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ MCP —Å–µ—Ä–≤–µ—Ä —Å–æ–±—Ä–∞–Ω
if [ ! -f "dist/index.js" ]; then
    echo "üì¶ –°–æ–±–∏—Ä–∞–µ–º MCP —Å–µ—Ä–≤–µ—Ä..."
    npm run build
fi

echo "‚úÖ –í—Å–µ –≥–æ—Ç–æ–≤–æ!"
echo ""
echo "üåê –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: http://localhost:5001"
echo "üí¨ –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞: python3 mistral_mcp_client.py '–≤–∞—à –∑–∞–ø—Ä–æ—Å'"
echo ""
echo "üî• –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º:"
echo "1) –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)"
echo "2) –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞"
echo ""

read -p "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä (1 –∏–ª–∏ 2): " choice

case $choice in
    1)
        echo "üåê –ó–∞–ø—É—Å–∫–∞–µ–º –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å..."
        python3 web_interface.py
        ;;
    2)
        echo "üí¨ –†–µ–∂–∏–º –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏"
        read -p "üîç –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å: " query
        python3 mistral_mcp_client.py "$query"
        ;;
    *)
        echo "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä"
        exit 1
        ;;
esac